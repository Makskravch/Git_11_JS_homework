<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <!-- <script src="src/script.js"></script> -->
</head>

<body>
    <div id="container"></div>
    <input type="button" value="Start" onclick="startGame()">

    <script>
        class Saper1D {
            constructor(cellCount = 10, mineCount = 4) {
                if (cellCount <= 0) {
                    throw new Error('Get more cellCount.')
                }
                if (mineCount <= 0) {
                    throw new Error('Get more mineCount.')
                }
                if (mineCount > cellCount) {
                    throw new Error('mineCount > cellCount')
                }
                this.cellCount = cellCount
                this.mineCount = mineCount
            }

            getMinePosition() {
                let positions = []
                for (let i = 0; i < this.mineCount; i++) {
                    let randNum = Math.floor(Math.random() * this.cellCount)
                    if (positions.includes(randNum)) {
                        i--
                        continue
                    }
                    positions.push(randNum)
                }
                return positions
            }

            cellClick() {
                let td = this

                if (td.getAttribute('isMine') == '1') {
                    td.style.background = 'red'
                } else {
                    td.style.background = 'green'
                    //Рух вліво
                    let siblin = td.previousElementSibling;
                    while (siblin) {
                        if (siblin.getAttribute("isMine") == "0") {
                            siblin.style.background = "green";
                            siblin = siblin.previousElementSibling;
                        }
                        else
                            break;
                    }
                    //Рух вправо
                    siblin = td.nextElementSibling;
                    while (siblin) {
                        if (siblin.getAttribute("isMine") == "0") {
                            siblin.style.background = "green";
                            siblin = siblin.nextElementSibling;
                        }
                        else
                            break;
                    }
                }
            }

            render(containreId) {
                let minePosition = this.getMinePosition()
                let table = document.createElement('table')
                table.border = '1px solid black'

                let tr = document.createElement('tr')

                for (let i = 0; i < this.cellCount; i++) {
                    let td = document.createElement('td')
                    td.innerText = '*'
                    td.setAttribute('isMine', (minePosition.includes(i)) ? '1' : '0')
                    td.onclick = this.cellClick
                    tr.appendChild(td)
                }

                table.appendChild(tr)
                document.getElementById(containreId).appendChild(table)
            }
        }

        function startGame() {
            let saper = new Saper1D()
            saper.render('container')
        }
    </script>
    </body>

</html>